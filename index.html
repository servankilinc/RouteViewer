<!DOCTYPE html>
<html>
<body>
<h1>HTML5 Canvas Draw Image</h1>

<div style="display:none;">
<img id="scream" width="220" height="277" src="https://hastaneler.erciyes.edu.tr/EditorUpload/Files/e24c1f50-62a7-4537-8579-8b2ff8edbee9.jpg">
</div>

<canvas id="myCanvas" width="720" height="500" style="border:1px solid grey;">
Sorry, your browser does not support canvas.
</canvas>

<script>
const canvas_width = 720;
const canvas_height = 500;
const radius = 10;
const edges = [];

const canvas = document.getElementById("myCanvas");
const ctx = canvas.getContext("2d");
const image = document.getElementById("scream");

image.addEventListener("load", (e) => {
  ctx.drawImage(image, 0, 0, canvas_width, canvas_height);
});

function getCursorPosition(canvas, event) {
    const rect = canvas.getBoundingClientRect()
    const x = Math.round(event.clientX - rect.left);
    const y = Math.round(event.clientY - rect.top);

    if(isValidCord(x,y)){
        edges.push({x:x, y:y})
        
        ctx.beginPath();
        ctx.arc(x, y, radius, 0, 2 * Math.PI);
        ctx.fillStyle = "orange";
        ctx.fill();
    }
    else{
        clearEdge(x,y);
    }
}

canvas.addEventListener('mousedown', function(e) {
    getCursorPosition(canvas, e)
})

function isValidCord(x,y){
    var distance = radius*2;
    if(edges.length == 0){return true;}

    var control = true;
    edges.map(edge => {
        if(control){
            control = Math.sqrt((edge.x-x)*(edge.x-x) + (edge.y-y)*(edge.y-y)) < distance ? false:true;
            console.log("dis = ",Math.sqrt((edge.x-x)*(edge.x-x) + (edge.y-y)*(edge.y-y)))
        }
    })

    return control;
}

function clearEdge(x,y){
    var index = edges.findIndex(edge=> (x+radius >= edge.x && edge.x >= x-radius) && (y+radius >= edge.y && edge.y >= y-radius))
    if(index != "-1"){
        var relatedEdge=edges[index];
        console.log("bulunan",relatedEdge);
        ctx.clearRect(relatedEdge.x-radius,relatedEdge.y - radius, radius*2, radius*2);
        edges.splice(index,1);
    }
}
</script>

</body>
</html>
